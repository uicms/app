{% trans_default_domain 'app' %}
{% if url is not defined %}
    {% set url = path('app_page_action_id_key', {'locale': app.session.get('locale'), 'slug': app.session.get('contributions_page_slug'), 'action':'view', 'id':item.id, 'key': item.name|slugger}) %}
{% endif %}

<article class="item contribution{% if item._thumbnail is defined and item._thumbnail %} has_thumbnail{% endif %}">
    <div class="wrapper">
        
        
        {% if item._thumbnail is defined and item._thumbnail %}
        <aside>
            <div class="item_thumbnail">
                <div class="wrapper">
                    <a href="{{ url }}{% if filters is defined %}?{{ filters.url }}{% endif %}" class="" data-url="{{ url }}{% if filters is defined %}?{{ filters.url }}{% endif %}">
                    {% if item._thumbnail %}<img src="/uploads/{{ item._thumbnail }}" class="{% if item._thumbnail_class is defined %}{{ item._thumbnail_class }}{% endif %}" />{% endif %}
                    </a>
                </div>
            </div>
        </aside>
        {% endif %}
        
        <div class="item_content">
            <div class="item_details">
                <h2 class="item_name">
                    <a href="{{ url }}{% if filters is defined %}?{{ filters.url }}{% endif %}" class="" data-url="{{ url }}{% if filters is defined %}?{{ filters.url }}{% endif %}">
                        {{ item.name|raw }}
                    </a>
                </h2>
            
                <div class="item_description">
                    {{ item.description|length > 140 ? (item.description|striptags|slice(0, 140) ~ '...')|raw  : item.description|raw  }}
                </div>

                {% include 'app/tpl/contributions/infos.html.twig' %}
            </div>

            <div class="item_tools">
                {% if item.count_likes %}<psan class="num_likes">{{ item.count_likes }}</psan>{% endif %}
                {% if item.count_answers %}<psan class="num_answers">{{ item.count_answers }}</psan>{% endif %}
                <span class="status {% if item.contributionStatus %}{{ item.contributionStatus.slug }}{% endif %}">
                {% if item.contributionType %}{{ item.contributionType.name }} {% endif %}
                {% if item.contributionStatus %}<span >{{ item.contributionStatus.name|lower }}</span>{% endif %}
                </span>
            
                {% if item.is_selected is defined and item.is_selected is same as(true) %}
                <a href="{{ path('app_page_action', {'locale': app.session.get('locale'), 'slug': app.session.get('contributions_page_slug'), 'action': 'deletefromselection'}) }}?{{ filters.url }}&amp;id={{ item.id }}" class="button add_to_selection">Retirer</a>
                {% elseif item.is_selected is same as(false) %}
                <a href="{{ path('app_page_action', {'locale': app.session.get('locale'), 'slug': app.session.get('contributions_page_slug'), 'action': 'addtoselection'}) }}?{{ filters.url }}&amp;id={{ item.id }}" class="button add_to_selection">SÃ©lectionner</a>
                {% endif %}
            </div>
        </div>
    </div>
</article>
